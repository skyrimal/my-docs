# Eureka服务f发现Discovery

通过Eureka服务端（Client）启动时注册的DiscoveryClient类来获取注册进Eureka的所有服务（payment、order）的基础信息

## 主启动类启动DiscoveryClient

```java
@SpringBootApplication
@EnableEurekaClient//启动客户端eureka（进行注册）
//注册到服务发现组件
@EnableDiscoveryClient//启动Discovery应用端获取服务注册中心中的基础注册信息
public class PaymentMain8001 {
    public static void main(String[] args) {
        SpringApplication.run(PaymentMain8001.class,args);
    }
}
```



## Controller调用DiscoveryClient获取服务注册中心的基础信息

```java
@RestController
@Slf4j
public class PaymentController {
	private DiscoveryClient discoveryClient;

    @Autowired
    public void setDiscoveryClient(DiscoveryClient discoveryClient) {
        this.discoveryClient = discoveryClient;
    }
    @GetMapping("/payment/discovery")
    public Object discovery() {
        //所有微服务的名称
        List<String> services = discoveryClient.getServices();
        for (String element : services) {
            log.info("*******element: " + element);
        }
        //一个微服务下的全部实例（实例组成集群）
        List<ServiceInstance> instances =
                discoveryClient.getInstances("CLOUD-PAYMENT-SERVICE");
        for (ServiceInstance instance : instances) {
            //实例id+主机名称+端口号+uri地址
            log.info(instance.getInstanceId()+"\t"
                             +instance.getHost()+"\t"
                             +instance.getPort()+"\t"
                             +instance.getUri());
        }
        return this.discoveryClient;
    }
}
```

## 调用接口后

### 页面返回

![image-20200706211814384](../%E5%9B%BE%E7%89%87/%E9%A1%B5%E9%9D%A2%E8%BF%94%E5%9B%9E%E8%8E%B7%E5%8F%96DiscoveryClient.png)

### 控制台打印日志

![image-20200706211928058](../%E5%9B%BE%E7%89%87/log%E6%89%93%E5%8D%B0DiscoveryClient%E4%BF%A1%E6%81%AF.png)