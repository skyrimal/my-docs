# Consul

CP 主要C数据一致性

>Consul是一个服务网格（微服务间的 TCP/IP，负责服务之间的网络调用、限流、熔断和监控）解决方案，它是一个一个分布式的，高度可用的系统，而且开发使用都很简便。它提供了一个功能齐全的控制平面，主要特点是：服务发现、健康检查、键值存储、安全服务通信、多数据中心。

	Consul是HashiCorp公司推出的开源工具,用于实现分布式系统的服务发现与配置。 Consul是分布式的、高可用的、可横向扩展的。它具备以下特性 :

> service discovery:consul通过DNS或者HTTP接口使服务注册和服务发现变的很容易,一些外部服务,例如saas提供的也可以一样注册。 health checking:健康检测使consul可以快速的告警在集群中的操作。和服务发现的集成,可以防止服务转发到故障的服务上面。key/value storage:一个用来存储动态配置的系统。提供简单的HTTP接口,可以在任何地方操作。multi-datacenter:无需复杂的配置,即可支持任意数量的区域。
>

##consul的安装

  （1）进入consul官网找到自己开发平台对应的安装包下载 https://www.consul.io/downloads.html

​			或者   wget https://releases.hashicorp.com/consul/1.5.1/consul_1.5.1_linux_amd64.zip

  （2）下载完后，解压，得到一个可执行文件consul

  （3）将这个文件移动到全局变量环境中

​		   $ sudo mv consul /usr/local/bin/

  （4）验证是否安装成功

​		   $ consul

​	(5) 启动

​			./consul agent -dev -ui -node=consul-dev -client=192.168.42.25

##consul说明

（1）consul角色
   client: 客户端, 无状态, 将 HTTP 和 DNS 接口请求转发给局域网内的服务端集群.
   server: 服务端, 保存配置信息, 高可用集群, 在局域网内与本地客户端通讯, 通过广域网与其他数据中心通讯. 每个数据中心的         server 数量推荐为 3 个或是 5 个。
（2）运行 consul代理
    consul是典型的 C/S架构,可以运行服务模式或客户模式。每一个数据中心必须有至少一个服务节点, 3到5个服)务节点最好。非      常不建议只运行一个服务节点,因为在节点失效的情况下数据有极大的丢失风险。
（3）运行Agent
     完成Consul的安装后,必须运行agent。agent可以运行为server或client模式.每个数据中心至少必须拥有一台server。建议在一      个集群中有3或者5个server。部署单一的server,在出现失败时会不可避免的造成数据丢失。其他的agent运行为client模式。一    个client是一个非常轻量级的进程。用于注册服务,运行健康检查和转发对server的查询。agent必须在集群中的每个主机上运行。



