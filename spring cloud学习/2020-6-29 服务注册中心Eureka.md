#服务注册中心

服务注册中心，即当微服务数量达到一定限制后，使用的管理维服务的***==服务==***

AP  主要A高可用

## pom

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <parent>
        <artifactId>cloud2020</artifactId>
        <groupId>com.atguigu.springcloud</groupId>
        <version>1.0-SNAPSHOT</version>
    </parent>
    <modelVersion>4.0.0</modelVersion>

    <artifactId>cloud-eureka-server7001</artifactId>

    <dependencies>
        <!-- 添加eureka依赖 指明是server端 -->
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-netflix-eureka-server</artifactId>
        </dependency>

        <!-- springboot web 标配 -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>
        <dependency>
            <groupId>com.atguigu.springcloud</groupId>
            <artifactId>cloud-api-commons</artifactId>
            <version>1.0-SNAPSHOT</version>
        </dependency>
    </dependencies>
</project>
```

## yml

```yml
server:
  port: 7001

eureka:
  instance:
    hostname: localhost #eureka服务器实例名
  client:
    register-with-eureka: false #禁止自己当做服务注册 #服务注册中心不管理自身
    fetch-registry: false #屏蔽注册信息 #不检索（监听？？）没道理检索自己，要检索的是注册入服务器的应用微服务
    service-url:
      #注册自身
      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka
```



## 主启动类

```java

@SpringBootApplication
@EnableEurekaServer//声明eureka并声明启动的是服务器端
public class EurekaMain7001 {
    public static void main(String[] args) {
        SpringApplication.run(EurekaMain7001.class,args);
    }
}
```



## 启动后访问[服务注册中心](http://localhost:7001/)

![image-20200629221953828](../%E5%9B%BE%E7%89%87/%E5%90%AF%E5%8A%A8%E5%90%8E%E8%AE%BF%E9%97%AEeureka.png)

# 微服务注册

## payment8001注册进eureka

 ### 1.pom添加客户端依赖

```xml
	   <!--eureka 服务注册客户端 netflix==豪猪哥-->
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
        </dependency>
```

### 2.主启动类上启动eureka客户端

```java
@SpringBootApplication
@EnableEurekaClient//启动客户端eureka,进行注册==》以客户端启动进行注册
public class PaymentMain8001 {
    public static void main(String[] args) {
        SpringApplication.run(PaymentMain8001.class,args);
    }
}

```

### 3.修改yml文件

```yml
spring:
  application:
    name: cloud-payment-service #服务名，当注册入服务管理中心时显示==大写name
#进行注册的配置
eureka:
  client:
    #是否注册进服务注册中心==默认true
    register-with-eureka: true
    #注册后服务注册中心是否监控==默认true
    fetch-registry: true
    service-url:
      #注册到==服务器注册中心开发的注册渠道
      defaultZone: http://localhost:7001/eureka
```

###完成注册后

![image-20200629222157537](../%E5%9B%BE%E7%89%87/%E6%B3%A8%E5%86%8Cpayment8001%E5%88%B0eureka.png)

## 同理注册order80到eureka

###pom添加eureka客户端依赖

### yml文件

```yml
server:
  port: 80
#给消费端添加应用名
spring:
  application:
    name: cloud-consumer-order
eureka:
  client:
    service-url:
      #注册到==服务器注册中心开发的注册渠道
      defaultZone: http://localhost:7001/eureka
```

##主启动类添加@EnableEurekaClient以客户端启动进行注册

### 完成注册后

![image-20200629223717097](../%E5%9B%BE%E7%89%87/oder80%E6%B3%A8%E5%86%8C%E5%88%B0Eureka.png)