# 发布订阅模型–动态路由

## 1.绑定队列时使用通配符

*号匹配一个单词，#匹配多个单词

命名规则 word1.word2.word3 == word1.word2.* ==word1.#

## 生产者

```java
channel.exchangeDeclare(RabbitMqManage.EXCHANGE_TOPIC, BuiltinExchangeType.TOPIC);

String routingKey1 = "key.1.1";
String routingKey2 = "key.2";
String routingKey3 = "key.3";
String routingKey4 = "key.4";
String routingKey5 = "key.5";

manage.sendMessage(channel,RabbitMqManage.EXCHANGE_TOPIC,"测试TOPIC模式，路由通配符"+routingKey1,routingKey1);
manage.sendMessage(channel,RabbitMqManage.EXCHANGE_TOPIC,"测试TOPIC模式，路由通配符"+routingKey2,routingKey2);
manage.sendMessage(channel,RabbitMqManage.EXCHANGE_TOPIC,"测试TOPIC模式，路由通配符"+routingKey3,routingKey3);
manage.sendMessage(channel,RabbitMqManage.EXCHANGE_TOPIC,"测试TOPIC模式，路由通配符"+routingKey4,routingKey4);
manage.sendMessage(channel,RabbitMqManage.EXCHANGE_TOPIC,"测试TOPIC模式，路由通配符"+routingKey5,routingKey5);
```

## 消费者

> 结果显示的是key.1.1路由

```java
String queue = channel.queueDeclare().getQueue();

channel.queueBind(queue,RabbitMqManage.EXCHANGE_TOPIC,"key.*.*");
channel.basicConsume(queue,new DefaultConsumer(channel){
    @Override
    public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body) throws IOException {
        System.out.println(new String(body,"utf-8"));
    }
});
```